<template name="layout1">
  <head>
    <title>Leaderboard</title>
    <meta name="viewport" content="width=device-width, user-scalable=no">
    <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600' rel='stylesheet' type='text/css'>
  </head>

  <body>
  <div class="navbar navbar-default" role="navigation">
    <div class="navbar-header">
      <a class="navbar-brand" href="{{pathFor 'Home'}}">Home</a>
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <div class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <!--li class="active"><a href="#">Link</a></li-->
      </ul>
      <ul class="nav navbar-nav navbar-right">
        {{> loginButtons}} <!-- here -->
      </ul>
    </div>
  </div>

  <div class="outer">
    {{parentDebug}}
    {{> Template.dynamic template=top}}
    {{> Template.dynamic template=main data=data}}
  </div>
  </body>
</template>

<template name="header">
  <div class="logo"></div>
  <h1 class="title"><a href="{{pathFor "Home"}}">Vending Machine Challenge</a></h1>
  <hr/>
</template>

<template name="not_found">
  <div class="subtitle">404</div>
  <div class="message">Nothing found here.</div>
</template>

<template name="overview">

  {{> overall_stats}}

  <hr/>
  <div class="subtitle">Leaderboard:</div>
  {{> leaderboard}}

  <hr/>
  <div class="subtitle">Foods:</div>
  {{> foodlist}}


  <div class="subtitle">Manage users / participants:</div>
  {{> manageUsers}}
  <hr/>

</template>

<template name="overall_stats">
  <div class="subtitle">Food stats:</div>
  <div class="message">{{totalItems}} items have been consumed so far.</div>
</template>


<template name="leaderboard">
  <ol class="leaderboard">
    {{#each player in players}}
      <li class="player">
        <span class="name"><a href="{{pathFor 'Player.show' _id=player._id}}">{{player.name}}</a></span>
        <span class="score">{{player.score}}</span>
      </li>
    {{/each}}
  </ol>
</template>

<template name="player_controller">
  <div class="subtitle">Inside player_controller: {{data.player._id}}</div>
  <div class="subtitle">Score: {{data.player.score}}</div>

  {{#if isInRole 'admin'}}
    <hr/>
    {{> quickForm collection="Players" doc=data.player id="updatePlayerForm" type="update" autosave=true}}
    {{> quickRemoveButton collection="Snacks" _id=data.snack._id}}
  {{/if}}
</template>

<template name="foodlist">
  <ol class="leaderboard">
    {{#each snack in snacks}}
      <li class="player">
        <span class="name"><a href="{{pathFor 'Snack.show' _id=snack._id}}">{{snack.name}}</a></span>
        <span class="score">{{snack.calories}}</span>
      </li>
    {{/each}}
  </ol>
  {{#if isInRole 'admin'}}
    <hr/>
    <div class="subtitle">Add a new snack:</div>
    {{> insertSnackForm}}
  {{/if}}
</template>

<template name="snack_controller">
  <div class="subtitle">Inside snack_controller: {{data.snack._id}}</div>
  <div class="subtitle">Calories: {{data.snack.score}}</div>

  {{> quickForm collection="Snacks" doc=data.snack id="updateSnackForm" type="update" autosave=true}}
  {{> quickRemoveButton collection="Snacks" _id=data.snack._id}}
</template>

<template name="insertSnackForm">
  {{> quickForm collection="Snacks" id="insertSnackForm" type="insert"}}
</template>

<template name="updateSnackForm">
  {{#if selectedSnack}}
    <div class="subtitle">Update snack:</div>
    {{> quickForm collection="Snacks" doc=selectedSnack id="updateSnackForm" type="update"}}

  {{/if}}
</template>






<template name="manageUsers">
  <ol class="leaderboard">
    {{#each allUsers}}
      {{> manageUser}}
    {{/each}}
  </ol>
</template>

<template name="manageUser">
  <li class="player {{selected}}">
    <span class="name">{{username}}</span>
    <span class="score"><button type="submit" class="btn btn-primary toggle">Submit</button></span>
  </li>
</template>